# StreamAdExchange Firewall Rules
# Interfaces
set skip on lo0

# Options
set block-policy drop
set fingerprints "/etc/pf.os"

# Normalization
scrub in all

# Default blocking
block all

# Allow established connections
pass out all keep state
pass in proto tcp from any to any flags S/SA keep state

# Allow specific services
pass in proto tcp from any to any port 80 flags S/SA keep state # HTTP
pass in proto tcp from any to any port 443 flags S/SA keep state # HTTPS
pass in proto tcp from any to any port 3000 flags S/SA keep state # Grafana
pass in proto tcp from any to any port 9090 flags S/SA keep state # Prometheus
pass in proto tcp from any to any port 9100 flags S/SA keep state # Node Exporter
pass in proto tcp from any to any port 9113 flags S/SA keep state # Nginx Exporter
pass in proto tcp from any to any port 5000 flags S/SA keep state # Flask App
